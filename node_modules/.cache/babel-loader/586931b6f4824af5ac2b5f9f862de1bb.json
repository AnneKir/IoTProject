{"ast":null,"code":"var Buffer = require('safe-buffer').Buffer;\nvar ZEROES = Buffer.alloc(16, 0);\nfunction toArray(buf) {\n  return [buf.readUInt32BE(0), buf.readUInt32BE(4), buf.readUInt32BE(8), buf.readUInt32BE(12)];\n}\nfunction fromArray(out) {\n  var buf = Buffer.allocUnsafe(16);\n  buf.writeUInt32BE(out[0] >>> 0, 0);\n  buf.writeUInt32BE(out[1] >>> 0, 4);\n  buf.writeUInt32BE(out[2] >>> 0, 8);\n  buf.writeUInt32BE(out[3] >>> 0, 12);\n  return buf;\n}\nfunction GHASH(key) {\n  this.h = key;\n  this.state = Buffer.alloc(16, 0);\n  this.cache = Buffer.allocUnsafe(0);\n}\n\n// from http://bitwiseshiftleft.github.io/sjcl/doc/symbols/src/core_gcm.js.html\n// by Juho V채h채-Herttua\nGHASH.prototype.ghash = function (block) {\n  var i = -1;\n  while (++i < block.length) {\n    this.state[i] ^= block[i];\n  }\n  this._multiply();\n};\nGHASH.prototype._multiply = function () {\n  var Vi = toArray(this.h);\n  var Zi = [0, 0, 0, 0];\n  var j, xi, lsbVi;\n  var i = -1;\n  while (++i < 128) {\n    xi = (this.state[~~(i / 8)] & 1 << 7 - i % 8) !== 0;\n    if (xi) {\n      // Z_i+1 = Z_i ^ V_i\n      Zi[0] ^= Vi[0];\n      Zi[1] ^= Vi[1];\n      Zi[2] ^= Vi[2];\n      Zi[3] ^= Vi[3];\n    }\n\n    // Store the value of LSB(V_i)\n    lsbVi = (Vi[3] & 1) !== 0;\n\n    // V_i+1 = V_i >> 1\n    for (j = 3; j > 0; j--) {\n      Vi[j] = Vi[j] >>> 1 | (Vi[j - 1] & 1) << 31;\n    }\n    Vi[0] = Vi[0] >>> 1;\n\n    // If LSB(V_i) is 1, V_i+1 = (V_i >> 1) ^ R\n    if (lsbVi) {\n      Vi[0] = Vi[0] ^ 0xe1 << 24;\n    }\n  }\n  this.state = fromArray(Zi);\n};\nGHASH.prototype.update = function (buf) {\n  this.cache = Buffer.concat([this.cache, buf]);\n  var chunk;\n  while (this.cache.length >= 16) {\n    chunk = this.cache.slice(0, 16);\n    this.cache = this.cache.slice(16);\n    this.ghash(chunk);\n  }\n};\nGHASH.prototype.final = function (abl, bl) {\n  if (this.cache.length) {\n    this.ghash(Buffer.concat([this.cache, ZEROES], 16));\n  }\n  this.ghash(fromArray([0, abl, 0, bl]));\n  return this.state;\n};\nmodule.exports = GHASH;","map":{"version":3,"names":["Buffer","require","ZEROES","alloc","toArray","buf","readUInt32BE","fromArray","out","allocUnsafe","writeUInt32BE","GHASH","key","h","state","cache","prototype","ghash","block","i","length","_multiply","Vi","Zi","j","xi","lsbVi","update","concat","chunk","slice","final","abl","bl","module","exports"],"sources":["C:/Users/Amali/Desktop/Building_the_IoT_w._P2P_and_Cloud_Computing/IoTProject/node_modules/browserify-aes/ghash.js"],"sourcesContent":["var Buffer = require('safe-buffer').Buffer\r\nvar ZEROES = Buffer.alloc(16, 0)\r\n\r\nfunction toArray (buf) {\r\n  return [\r\n    buf.readUInt32BE(0),\r\n    buf.readUInt32BE(4),\r\n    buf.readUInt32BE(8),\r\n    buf.readUInt32BE(12)\r\n  ]\r\n}\r\n\r\nfunction fromArray (out) {\r\n  var buf = Buffer.allocUnsafe(16)\r\n  buf.writeUInt32BE(out[0] >>> 0, 0)\r\n  buf.writeUInt32BE(out[1] >>> 0, 4)\r\n  buf.writeUInt32BE(out[2] >>> 0, 8)\r\n  buf.writeUInt32BE(out[3] >>> 0, 12)\r\n  return buf\r\n}\r\n\r\nfunction GHASH (key) {\r\n  this.h = key\r\n  this.state = Buffer.alloc(16, 0)\r\n  this.cache = Buffer.allocUnsafe(0)\r\n}\r\n\r\n// from http://bitwiseshiftleft.github.io/sjcl/doc/symbols/src/core_gcm.js.html\r\n// by Juho V채h채-Herttua\r\nGHASH.prototype.ghash = function (block) {\r\n  var i = -1\r\n  while (++i < block.length) {\r\n    this.state[i] ^= block[i]\r\n  }\r\n  this._multiply()\r\n}\r\n\r\nGHASH.prototype._multiply = function () {\r\n  var Vi = toArray(this.h)\r\n  var Zi = [0, 0, 0, 0]\r\n  var j, xi, lsbVi\r\n  var i = -1\r\n  while (++i < 128) {\r\n    xi = (this.state[~~(i / 8)] & (1 << (7 - (i % 8)))) !== 0\r\n    if (xi) {\r\n      // Z_i+1 = Z_i ^ V_i\r\n      Zi[0] ^= Vi[0]\r\n      Zi[1] ^= Vi[1]\r\n      Zi[2] ^= Vi[2]\r\n      Zi[3] ^= Vi[3]\r\n    }\r\n\r\n    // Store the value of LSB(V_i)\r\n    lsbVi = (Vi[3] & 1) !== 0\r\n\r\n    // V_i+1 = V_i >> 1\r\n    for (j = 3; j > 0; j--) {\r\n      Vi[j] = (Vi[j] >>> 1) | ((Vi[j - 1] & 1) << 31)\r\n    }\r\n    Vi[0] = Vi[0] >>> 1\r\n\r\n    // If LSB(V_i) is 1, V_i+1 = (V_i >> 1) ^ R\r\n    if (lsbVi) {\r\n      Vi[0] = Vi[0] ^ (0xe1 << 24)\r\n    }\r\n  }\r\n  this.state = fromArray(Zi)\r\n}\r\n\r\nGHASH.prototype.update = function (buf) {\r\n  this.cache = Buffer.concat([this.cache, buf])\r\n  var chunk\r\n  while (this.cache.length >= 16) {\r\n    chunk = this.cache.slice(0, 16)\r\n    this.cache = this.cache.slice(16)\r\n    this.ghash(chunk)\r\n  }\r\n}\r\n\r\nGHASH.prototype.final = function (abl, bl) {\r\n  if (this.cache.length) {\r\n    this.ghash(Buffer.concat([this.cache, ZEROES], 16))\r\n  }\r\n\r\n  this.ghash(fromArray([0, abl, 0, bl]))\r\n  return this.state\r\n}\r\n\r\nmodule.exports = GHASH\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}