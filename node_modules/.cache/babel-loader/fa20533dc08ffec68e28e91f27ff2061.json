{"ast":null,"code":"'use strict';\n\nvar BN = require('bn.js');\nvar utils = require('../utils');\nvar assert = utils.assert;\nfunction Signature(options, enc) {\n  if (options instanceof Signature) return options;\n  if (this._importDER(options, enc)) return;\n  assert(options.r && options.s, 'Signature without r or s');\n  this.r = new BN(options.r, 16);\n  this.s = new BN(options.s, 16);\n  if (options.recoveryParam === undefined) this.recoveryParam = null;else this.recoveryParam = options.recoveryParam;\n}\nmodule.exports = Signature;\nfunction Position() {\n  this.place = 0;\n}\nfunction getLength(buf, p) {\n  var initial = buf[p.place++];\n  if (!(initial & 0x80)) {\n    return initial;\n  }\n  var octetLen = initial & 0xf;\n\n  // Indefinite length or overflow\n  if (octetLen === 0 || octetLen > 4) {\n    return false;\n  }\n  var val = 0;\n  for (var i = 0, off = p.place; i < octetLen; i++, off++) {\n    val <<= 8;\n    val |= buf[off];\n    val >>>= 0;\n  }\n\n  // Leading zeroes\n  if (val <= 0x7f) {\n    return false;\n  }\n  p.place = off;\n  return val;\n}\nfunction rmPadding(buf) {\n  var i = 0;\n  var len = buf.length - 1;\n  while (!buf[i] && !(buf[i + 1] & 0x80) && i < len) {\n    i++;\n  }\n  if (i === 0) {\n    return buf;\n  }\n  return buf.slice(i);\n}\nSignature.prototype._importDER = function _importDER(data, enc) {\n  data = utils.toArray(data, enc);\n  var p = new Position();\n  if (data[p.place++] !== 0x30) {\n    return false;\n  }\n  var len = getLength(data, p);\n  if (len === false) {\n    return false;\n  }\n  if (len + p.place !== data.length) {\n    return false;\n  }\n  if (data[p.place++] !== 0x02) {\n    return false;\n  }\n  var rlen = getLength(data, p);\n  if (rlen === false) {\n    return false;\n  }\n  var r = data.slice(p.place, rlen + p.place);\n  p.place += rlen;\n  if (data[p.place++] !== 0x02) {\n    return false;\n  }\n  var slen = getLength(data, p);\n  if (slen === false) {\n    return false;\n  }\n  if (data.length !== slen + p.place) {\n    return false;\n  }\n  var s = data.slice(p.place, slen + p.place);\n  if (r[0] === 0) {\n    if (r[1] & 0x80) {\n      r = r.slice(1);\n    } else {\n      // Leading zeroes\n      return false;\n    }\n  }\n  if (s[0] === 0) {\n    if (s[1] & 0x80) {\n      s = s.slice(1);\n    } else {\n      // Leading zeroes\n      return false;\n    }\n  }\n  this.r = new BN(r);\n  this.s = new BN(s);\n  this.recoveryParam = null;\n  return true;\n};\nfunction constructLength(arr, len) {\n  if (len < 0x80) {\n    arr.push(len);\n    return;\n  }\n  var octets = 1 + (Math.log(len) / Math.LN2 >>> 3);\n  arr.push(octets | 0x80);\n  while (--octets) {\n    arr.push(len >>> (octets << 3) & 0xff);\n  }\n  arr.push(len);\n}\nSignature.prototype.toDER = function toDER(enc) {\n  var r = this.r.toArray();\n  var s = this.s.toArray();\n\n  // Pad values\n  if (r[0] & 0x80) r = [0].concat(r);\n  // Pad values\n  if (s[0] & 0x80) s = [0].concat(s);\n  r = rmPadding(r);\n  s = rmPadding(s);\n  while (!s[0] && !(s[1] & 0x80)) {\n    s = s.slice(1);\n  }\n  var arr = [0x02];\n  constructLength(arr, r.length);\n  arr = arr.concat(r);\n  arr.push(0x02);\n  constructLength(arr, s.length);\n  var backHalf = arr.concat(s);\n  var res = [0x30];\n  constructLength(res, backHalf.length);\n  res = res.concat(backHalf);\n  return utils.encode(res, enc);\n};","map":{"version":3,"names":["BN","require","utils","assert","Signature","options","enc","_importDER","r","s","recoveryParam","undefined","module","exports","Position","place","getLength","buf","p","initial","octetLen","val","i","off","rmPadding","len","length","slice","prototype","data","toArray","rlen","slen","constructLength","arr","push","octets","Math","log","LN2","toDER","concat","backHalf","res","encode"],"sources":["C:/Users/Amali/Desktop/Building_the_IoT_w._P2P_and_Cloud_Computing/IoTProject/node_modules/elliptic/lib/elliptic/ec/signature.js"],"sourcesContent":["'use strict';\r\n\r\nvar BN = require('bn.js');\r\n\r\nvar utils = require('../utils');\r\nvar assert = utils.assert;\r\n\r\nfunction Signature(options, enc) {\r\n  if (options instanceof Signature)\r\n    return options;\r\n\r\n  if (this._importDER(options, enc))\r\n    return;\r\n\r\n  assert(options.r && options.s, 'Signature without r or s');\r\n  this.r = new BN(options.r, 16);\r\n  this.s = new BN(options.s, 16);\r\n  if (options.recoveryParam === undefined)\r\n    this.recoveryParam = null;\r\n  else\r\n    this.recoveryParam = options.recoveryParam;\r\n}\r\nmodule.exports = Signature;\r\n\r\nfunction Position() {\r\n  this.place = 0;\r\n}\r\n\r\nfunction getLength(buf, p) {\r\n  var initial = buf[p.place++];\r\n  if (!(initial & 0x80)) {\r\n    return initial;\r\n  }\r\n  var octetLen = initial & 0xf;\r\n\r\n  // Indefinite length or overflow\r\n  if (octetLen === 0 || octetLen > 4) {\r\n    return false;\r\n  }\r\n\r\n  var val = 0;\r\n  for (var i = 0, off = p.place; i < octetLen; i++, off++) {\r\n    val <<= 8;\r\n    val |= buf[off];\r\n    val >>>= 0;\r\n  }\r\n\r\n  // Leading zeroes\r\n  if (val <= 0x7f) {\r\n    return false;\r\n  }\r\n\r\n  p.place = off;\r\n  return val;\r\n}\r\n\r\nfunction rmPadding(buf) {\r\n  var i = 0;\r\n  var len = buf.length - 1;\r\n  while (!buf[i] && !(buf[i + 1] & 0x80) && i < len) {\r\n    i++;\r\n  }\r\n  if (i === 0) {\r\n    return buf;\r\n  }\r\n  return buf.slice(i);\r\n}\r\n\r\nSignature.prototype._importDER = function _importDER(data, enc) {\r\n  data = utils.toArray(data, enc);\r\n  var p = new Position();\r\n  if (data[p.place++] !== 0x30) {\r\n    return false;\r\n  }\r\n  var len = getLength(data, p);\r\n  if (len === false) {\r\n    return false;\r\n  }\r\n  if ((len + p.place) !== data.length) {\r\n    return false;\r\n  }\r\n  if (data[p.place++] !== 0x02) {\r\n    return false;\r\n  }\r\n  var rlen = getLength(data, p);\r\n  if (rlen === false) {\r\n    return false;\r\n  }\r\n  var r = data.slice(p.place, rlen + p.place);\r\n  p.place += rlen;\r\n  if (data[p.place++] !== 0x02) {\r\n    return false;\r\n  }\r\n  var slen = getLength(data, p);\r\n  if (slen === false) {\r\n    return false;\r\n  }\r\n  if (data.length !== slen + p.place) {\r\n    return false;\r\n  }\r\n  var s = data.slice(p.place, slen + p.place);\r\n  if (r[0] === 0) {\r\n    if (r[1] & 0x80) {\r\n      r = r.slice(1);\r\n    } else {\r\n      // Leading zeroes\r\n      return false;\r\n    }\r\n  }\r\n  if (s[0] === 0) {\r\n    if (s[1] & 0x80) {\r\n      s = s.slice(1);\r\n    } else {\r\n      // Leading zeroes\r\n      return false;\r\n    }\r\n  }\r\n\r\n  this.r = new BN(r);\r\n  this.s = new BN(s);\r\n  this.recoveryParam = null;\r\n\r\n  return true;\r\n};\r\n\r\nfunction constructLength(arr, len) {\r\n  if (len < 0x80) {\r\n    arr.push(len);\r\n    return;\r\n  }\r\n  var octets = 1 + (Math.log(len) / Math.LN2 >>> 3);\r\n  arr.push(octets | 0x80);\r\n  while (--octets) {\r\n    arr.push((len >>> (octets << 3)) & 0xff);\r\n  }\r\n  arr.push(len);\r\n}\r\n\r\nSignature.prototype.toDER = function toDER(enc) {\r\n  var r = this.r.toArray();\r\n  var s = this.s.toArray();\r\n\r\n  // Pad values\r\n  if (r[0] & 0x80)\r\n    r = [ 0 ].concat(r);\r\n  // Pad values\r\n  if (s[0] & 0x80)\r\n    s = [ 0 ].concat(s);\r\n\r\n  r = rmPadding(r);\r\n  s = rmPadding(s);\r\n\r\n  while (!s[0] && !(s[1] & 0x80)) {\r\n    s = s.slice(1);\r\n  }\r\n  var arr = [ 0x02 ];\r\n  constructLength(arr, r.length);\r\n  arr = arr.concat(r);\r\n  arr.push(0x02);\r\n  constructLength(arr, s.length);\r\n  var backHalf = arr.concat(s);\r\n  var res = [ 0x30 ];\r\n  constructLength(res, backHalf.length);\r\n  res = res.concat(backHalf);\r\n  return utils.encode(res, enc);\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}