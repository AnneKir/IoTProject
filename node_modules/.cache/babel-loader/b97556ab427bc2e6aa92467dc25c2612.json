{"ast":null,"code":"'use strict';\n\nvar assert = require('minimalistic-assert');\nvar inherits = require('inherits');\nvar utils = require('./utils');\nvar Cipher = require('./cipher');\nfunction DESState() {\n  this.tmp = new Array(2);\n  this.keys = null;\n}\nfunction DES(options) {\n  Cipher.call(this, options);\n  var state = new DESState();\n  this._desState = state;\n  this.deriveKeys(state, options.key);\n}\ninherits(DES, Cipher);\nmodule.exports = DES;\nDES.create = function create(options) {\n  return new DES(options);\n};\nvar shiftTable = [1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1];\nDES.prototype.deriveKeys = function deriveKeys(state, key) {\n  state.keys = new Array(16 * 2);\n  assert.equal(key.length, this.blockSize, 'Invalid key length');\n  var kL = utils.readUInt32BE(key, 0);\n  var kR = utils.readUInt32BE(key, 4);\n  utils.pc1(kL, kR, state.tmp, 0);\n  kL = state.tmp[0];\n  kR = state.tmp[1];\n  for (var i = 0; i < state.keys.length; i += 2) {\n    var shift = shiftTable[i >>> 1];\n    kL = utils.r28shl(kL, shift);\n    kR = utils.r28shl(kR, shift);\n    utils.pc2(kL, kR, state.keys, i);\n  }\n};\nDES.prototype._update = function _update(inp, inOff, out, outOff) {\n  var state = this._desState;\n  var l = utils.readUInt32BE(inp, inOff);\n  var r = utils.readUInt32BE(inp, inOff + 4);\n\n  // Initial Permutation\n  utils.ip(l, r, state.tmp, 0);\n  l = state.tmp[0];\n  r = state.tmp[1];\n  if (this.type === 'encrypt') this._encrypt(state, l, r, state.tmp, 0);else this._decrypt(state, l, r, state.tmp, 0);\n  l = state.tmp[0];\n  r = state.tmp[1];\n  utils.writeUInt32BE(out, l, outOff);\n  utils.writeUInt32BE(out, r, outOff + 4);\n};\nDES.prototype._pad = function _pad(buffer, off) {\n  var value = buffer.length - off;\n  for (var i = off; i < buffer.length; i++) {\n    buffer[i] = value;\n  }\n  return true;\n};\nDES.prototype._unpad = function _unpad(buffer) {\n  var pad = buffer[buffer.length - 1];\n  for (var i = buffer.length - pad; i < buffer.length; i++) {\n    assert.equal(buffer[i], pad);\n  }\n  return buffer.slice(0, buffer.length - pad);\n};\nDES.prototype._encrypt = function _encrypt(state, lStart, rStart, out, off) {\n  var l = lStart;\n  var r = rStart;\n\n  // Apply f() x16 times\n  for (var i = 0; i < state.keys.length; i += 2) {\n    var keyL = state.keys[i];\n    var keyR = state.keys[i + 1];\n\n    // f(r, k)\n    utils.expand(r, state.tmp, 0);\n    keyL ^= state.tmp[0];\n    keyR ^= state.tmp[1];\n    var s = utils.substitute(keyL, keyR);\n    var f = utils.permute(s);\n    var t = r;\n    r = (l ^ f) >>> 0;\n    l = t;\n  }\n\n  // Reverse Initial Permutation\n  utils.rip(r, l, out, off);\n};\nDES.prototype._decrypt = function _decrypt(state, lStart, rStart, out, off) {\n  var l = rStart;\n  var r = lStart;\n\n  // Apply f() x16 times\n  for (var i = state.keys.length - 2; i >= 0; i -= 2) {\n    var keyL = state.keys[i];\n    var keyR = state.keys[i + 1];\n\n    // f(r, k)\n    utils.expand(l, state.tmp, 0);\n    keyL ^= state.tmp[0];\n    keyR ^= state.tmp[1];\n    var s = utils.substitute(keyL, keyR);\n    var f = utils.permute(s);\n    var t = l;\n    l = (r ^ f) >>> 0;\n    r = t;\n  }\n\n  // Reverse Initial Permutation\n  utils.rip(l, r, out, off);\n};","map":{"version":3,"names":["assert","require","inherits","utils","Cipher","DESState","tmp","Array","keys","DES","options","call","state","_desState","deriveKeys","key","module","exports","create","shiftTable","prototype","equal","length","blockSize","kL","readUInt32BE","kR","pc1","i","shift","r28shl","pc2","_update","inp","inOff","out","outOff","l","r","ip","type","_encrypt","_decrypt","writeUInt32BE","_pad","buffer","off","value","_unpad","pad","slice","lStart","rStart","keyL","keyR","expand","s","substitute","f","permute","t","rip"],"sources":["C:/Users/Amali/Desktop/Building_the_IoT_w._P2P_and_Cloud_Computing/IoTProject/node_modules/des.js/lib/des/des.js"],"sourcesContent":["'use strict';\r\n\r\nvar assert = require('minimalistic-assert');\r\nvar inherits = require('inherits');\r\n\r\nvar utils = require('./utils');\r\nvar Cipher = require('./cipher');\r\n\r\nfunction DESState() {\r\n  this.tmp = new Array(2);\r\n  this.keys = null;\r\n}\r\n\r\nfunction DES(options) {\r\n  Cipher.call(this, options);\r\n\r\n  var state = new DESState();\r\n  this._desState = state;\r\n\r\n  this.deriveKeys(state, options.key);\r\n}\r\ninherits(DES, Cipher);\r\nmodule.exports = DES;\r\n\r\nDES.create = function create(options) {\r\n  return new DES(options);\r\n};\r\n\r\nvar shiftTable = [\r\n  1, 1, 2, 2, 2, 2, 2, 2,\r\n  1, 2, 2, 2, 2, 2, 2, 1\r\n];\r\n\r\nDES.prototype.deriveKeys = function deriveKeys(state, key) {\r\n  state.keys = new Array(16 * 2);\r\n\r\n  assert.equal(key.length, this.blockSize, 'Invalid key length');\r\n\r\n  var kL = utils.readUInt32BE(key, 0);\r\n  var kR = utils.readUInt32BE(key, 4);\r\n\r\n  utils.pc1(kL, kR, state.tmp, 0);\r\n  kL = state.tmp[0];\r\n  kR = state.tmp[1];\r\n  for (var i = 0; i < state.keys.length; i += 2) {\r\n    var shift = shiftTable[i >>> 1];\r\n    kL = utils.r28shl(kL, shift);\r\n    kR = utils.r28shl(kR, shift);\r\n    utils.pc2(kL, kR, state.keys, i);\r\n  }\r\n};\r\n\r\nDES.prototype._update = function _update(inp, inOff, out, outOff) {\r\n  var state = this._desState;\r\n\r\n  var l = utils.readUInt32BE(inp, inOff);\r\n  var r = utils.readUInt32BE(inp, inOff + 4);\r\n\r\n  // Initial Permutation\r\n  utils.ip(l, r, state.tmp, 0);\r\n  l = state.tmp[0];\r\n  r = state.tmp[1];\r\n\r\n  if (this.type === 'encrypt')\r\n    this._encrypt(state, l, r, state.tmp, 0);\r\n  else\r\n    this._decrypt(state, l, r, state.tmp, 0);\r\n\r\n  l = state.tmp[0];\r\n  r = state.tmp[1];\r\n\r\n  utils.writeUInt32BE(out, l, outOff);\r\n  utils.writeUInt32BE(out, r, outOff + 4);\r\n};\r\n\r\nDES.prototype._pad = function _pad(buffer, off) {\r\n  var value = buffer.length - off;\r\n  for (var i = off; i < buffer.length; i++)\r\n    buffer[i] = value;\r\n\r\n  return true;\r\n};\r\n\r\nDES.prototype._unpad = function _unpad(buffer) {\r\n  var pad = buffer[buffer.length - 1];\r\n  for (var i = buffer.length - pad; i < buffer.length; i++)\r\n    assert.equal(buffer[i], pad);\r\n\r\n  return buffer.slice(0, buffer.length - pad);\r\n};\r\n\r\nDES.prototype._encrypt = function _encrypt(state, lStart, rStart, out, off) {\r\n  var l = lStart;\r\n  var r = rStart;\r\n\r\n  // Apply f() x16 times\r\n  for (var i = 0; i < state.keys.length; i += 2) {\r\n    var keyL = state.keys[i];\r\n    var keyR = state.keys[i + 1];\r\n\r\n    // f(r, k)\r\n    utils.expand(r, state.tmp, 0);\r\n\r\n    keyL ^= state.tmp[0];\r\n    keyR ^= state.tmp[1];\r\n    var s = utils.substitute(keyL, keyR);\r\n    var f = utils.permute(s);\r\n\r\n    var t = r;\r\n    r = (l ^ f) >>> 0;\r\n    l = t;\r\n  }\r\n\r\n  // Reverse Initial Permutation\r\n  utils.rip(r, l, out, off);\r\n};\r\n\r\nDES.prototype._decrypt = function _decrypt(state, lStart, rStart, out, off) {\r\n  var l = rStart;\r\n  var r = lStart;\r\n\r\n  // Apply f() x16 times\r\n  for (var i = state.keys.length - 2; i >= 0; i -= 2) {\r\n    var keyL = state.keys[i];\r\n    var keyR = state.keys[i + 1];\r\n\r\n    // f(r, k)\r\n    utils.expand(l, state.tmp, 0);\r\n\r\n    keyL ^= state.tmp[0];\r\n    keyR ^= state.tmp[1];\r\n    var s = utils.substitute(keyL, keyR);\r\n    var f = utils.permute(s);\r\n\r\n    var t = l;\r\n    l = (r ^ f) >>> 0;\r\n    r = t;\r\n  }\r\n\r\n  // Reverse Initial Permutation\r\n  utils.rip(l, r, out, off);\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}