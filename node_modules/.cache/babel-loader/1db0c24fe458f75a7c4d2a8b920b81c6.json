{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst orderClause_1 = require(\"./orderClause\");\nconst no_decorator_exception_1 = require(\"../exceptions/no-decorator-exception\");\nconst __1 = require(\"..\");\nconst select_1 = require(\"./select/select\");\nconst order_by_1 = require(\"./order-by/order-by\");\nconst group_by_1 = require(\"./group-by/group-by\");\nclass TsQ {\n  constructor() {\n    this._orderby = new __1.Stack();\n  }\n  select() {\n    for (var _len = arguments.length, fields = new Array(_len), _key = 0; _key < _len; _key++) {\n      fields[_key] = arguments[_key];\n    }\n    this._select = select_1.select(fields, this._from, this._method);\n    return this;\n  }\n  static from(from) {\n    let tsq = new TsQ();\n    tsq._from = from;\n    try {\n      tsq._method = from.prototype._tsq_conf;\n    } catch (e) {\n      throw new no_decorator_exception_1.NoDecoratorException('TsQ decorator is missing from class ' + from.constructor.name);\n    }\n    return tsq;\n  }\n  where(f) {\n    this._where = f;\n    return this;\n  }\n  order_by(field) {\n    let direction = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'asc';\n    this._orderby.stack(new orderClause_1.OrderClause(field, direction));\n    return this;\n  }\n  group_by(field) {\n    this._groupby = field;\n    return this;\n  }\n  fetch() {\n    this.fromProcess().whereProcess().orderByProcess().selectProcess().groupByProcess();\n    return this._from;\n  }\n  /**\n   * Gets the data from class based on decorator configuration.\n   */\n  fromProcess() {\n    this._from = this._from[this._method]();\n    return this;\n  }\n  /**\n   * Filters data according to the calback provided in \"where\" clause.\n   */\n  whereProcess() {\n    if (this._where) this._from = this._from.filter(this._where);\n    return this;\n  }\n  /**\n   * Orders data\n   */\n  orderByProcess() {\n    this._from = order_by_1.orderBy(this._from, this._orderby);\n    return this;\n  }\n  /**\n   * Filters on provided fields list\n   */\n  selectProcess() {\n    if (this._select) {\n      this._from = select_1.selectFilter(this._from, this._select);\n      this._select = null;\n    }\n    return this;\n  }\n  /**\n   * Groups data by provided groups list\n   */\n  groupByProcess() {\n    if (this._groupby) this._from = group_by_1.groupBy(this._from, this._groupby);\n    return this;\n  }\n}\nexports.TsQ = TsQ;","map":{"version":3,"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;EAUIA;IACI,IAAI,CAACC,QAAQ,GAAG,IAAIC,SAAK,EAAe;EAC5C;EAEOC,MAAM,GAAiB;IAAA,kCAAbC,MAAa;MAAbA,MAAa;IAAA;IAC1B,IAAI,CAACC,OAAO,GAAGC,eAAM,CAACF,MAAM,EAAE,IAAI,CAACG,KAAK,EAAE,IAAI,CAACC,OAAO,CAAC;IACvD,OAAO,IAAI;EACf;EAEO,OAAOC,IAAI,CAACA,IAAS;IACxB,IAAIC,GAAG,GAAQ,IAAIC,GAAG,EAAE;IACxBD,GAAG,CAACH,KAAK,GAAGE,IAAI;IAChB,IAAI;MACAC,GAAG,CAACF,OAAO,GAAGC,IAAI,CAACG,SAAS,CAACC,SAAS;KACzC,CAAC,OAAOC,CAAC,EAAE;MACR,MAAM,IAAIC,6CAAoB,CAAC,sCAAsC,GAAGN,IAAI,CAACT,WAAW,CAACgB,IAAI,CAAC;;IAElG,OAAON,GAAG;EACd;EAEOO,KAAK,CAACC,CAAsB;IAC/B,IAAI,CAACC,MAAM,GAAGD,CAAC;IACf,OAAO,IAAI;EACf;EAEOE,QAAQ,CAACC,KAAa,EAA2B;IAAA,IAAzBC,gFAAoB,KAAK;IACpD,IAAI,CAACrB,QAAQ,CAACsB,KAAK,CAAC,IAAIC,yBAAW,CAACH,KAAK,EAAEC,SAAS,CAAC,CAAC;IACtD,OAAO,IAAI;EACf;EAEOG,QAAQ,CAACJ,KAAa;IACzB,IAAI,CAACK,QAAQ,GAAGL,KAAK;IACrB,OAAO,IAAI;EACf;EAEOM,KAAK;IACR,IAAI,CACCC,WAAW,EAAE,CACbC,YAAY,EAAE,CACdC,cAAc,EAAE,CAChBC,aAAa,EAAE,CACfC,cAAc,EAAE;IAErB,OAAO,IAAI,CAACzB,KAAK;EACrB;EAEA;;;EAGQqB,WAAW;IACf,IAAI,CAACrB,KAAK,GAAG,IAAI,CAACA,KAAK,CAAC,IAAI,CAACC,OAAO,CAAC,EAAE;IACvC,OAAO,IAAI;EACf;EAEA;;;EAGQqB,YAAY;IAChB,IAAI,IAAI,CAACV,MAAM,EACX,IAAI,CAACZ,KAAK,GAAG,IAAI,CAACA,KAAK,CAAC0B,MAAM,CAAC,IAAI,CAACd,MAAM,CAAC;IAC/C,OAAO,IAAI;EACf;EAEA;;;EAGQW,cAAc;IAClB,IAAI,CAACvB,KAAK,GAAG2B,kBAAO,CAAC,IAAI,CAAC3B,KAAK,EAAE,IAAI,CAACN,QAAQ,CAAC;IAC/C,OAAO,IAAI;EACf;EAEA;;;EAGQ8B,aAAa;IACjB,IAAI,IAAI,CAAC1B,OAAO,EAAE;MACd,IAAI,CAACE,KAAK,GAAGD,qBAAY,CAAC,IAAI,CAACC,KAAK,EAAE,IAAI,CAACF,OAAO,CAAC;MACnD,IAAI,CAACA,OAAO,GAAG,IAAI;;IAGvB,OAAO,IAAI;EACf;EAEA;;;EAGQ2B,cAAc;IAClB,IAAI,IAAI,CAACN,QAAQ,EACb,IAAI,CAACnB,KAAK,GAAG4B,kBAAO,CAAC,IAAI,CAAC5B,KAAK,EAAE,IAAI,CAACmB,QAAQ,CAAC;IAEnD,OAAO,IAAI;EACf;;AArGJU","names":["constructor","_orderby","__1","select","fields","_select","select_1","_from","_method","from","tsq","TsQ","prototype","_tsq_conf","e","no_decorator_exception_1","name","where","f","_where","order_by","field","direction","stack","orderClause_1","group_by","_groupby","fetch","fromProcess","whereProcess","orderByProcess","selectProcess","groupByProcess","filter","order_by_1","group_by_1","exports"],"sources":["../../src/tsQ/tsQ.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}