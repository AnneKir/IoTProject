{"ast":null,"code":"'use strict';\n\nvar utils = require('../utils');\nvar assert = utils.assert;\nvar parseBytes = utils.parseBytes;\nvar cachedProperty = utils.cachedProperty;\n\n/**\r\n* @param {EDDSA} eddsa - instance\r\n* @param {Object} params - public/private key parameters\r\n*\r\n* @param {Array<Byte>} [params.secret] - secret seed bytes\r\n* @param {Point} [params.pub] - public key point (aka `A` in eddsa terms)\r\n* @param {Array<Byte>} [params.pub] - public key point encoded as bytes\r\n*\r\n*/\nfunction KeyPair(eddsa, params) {\n  this.eddsa = eddsa;\n  this._secret = parseBytes(params.secret);\n  if (eddsa.isPoint(params.pub)) this._pub = params.pub;else this._pubBytes = parseBytes(params.pub);\n}\nKeyPair.fromPublic = function fromPublic(eddsa, pub) {\n  if (pub instanceof KeyPair) return pub;\n  return new KeyPair(eddsa, {\n    pub: pub\n  });\n};\nKeyPair.fromSecret = function fromSecret(eddsa, secret) {\n  if (secret instanceof KeyPair) return secret;\n  return new KeyPair(eddsa, {\n    secret: secret\n  });\n};\nKeyPair.prototype.secret = function secret() {\n  return this._secret;\n};\ncachedProperty(KeyPair, 'pubBytes', function pubBytes() {\n  return this.eddsa.encodePoint(this.pub());\n});\ncachedProperty(KeyPair, 'pub', function pub() {\n  if (this._pubBytes) return this.eddsa.decodePoint(this._pubBytes);\n  return this.eddsa.g.mul(this.priv());\n});\ncachedProperty(KeyPair, 'privBytes', function privBytes() {\n  var eddsa = this.eddsa;\n  var hash = this.hash();\n  var lastIx = eddsa.encodingLength - 1;\n  var a = hash.slice(0, eddsa.encodingLength);\n  a[0] &= 248;\n  a[lastIx] &= 127;\n  a[lastIx] |= 64;\n  return a;\n});\ncachedProperty(KeyPair, 'priv', function priv() {\n  return this.eddsa.decodeInt(this.privBytes());\n});\ncachedProperty(KeyPair, 'hash', function hash() {\n  return this.eddsa.hash().update(this.secret()).digest();\n});\ncachedProperty(KeyPair, 'messagePrefix', function messagePrefix() {\n  return this.hash().slice(this.eddsa.encodingLength);\n});\nKeyPair.prototype.sign = function sign(message) {\n  assert(this._secret, 'KeyPair can only verify');\n  return this.eddsa.sign(message, this);\n};\nKeyPair.prototype.verify = function verify(message, sig) {\n  return this.eddsa.verify(message, sig, this);\n};\nKeyPair.prototype.getSecret = function getSecret(enc) {\n  assert(this._secret, 'KeyPair is public only');\n  return utils.encode(this.secret(), enc);\n};\nKeyPair.prototype.getPublic = function getPublic(enc) {\n  return utils.encode(this.pubBytes(), enc);\n};\nmodule.exports = KeyPair;","map":{"version":3,"names":["utils","require","assert","parseBytes","cachedProperty","KeyPair","eddsa","params","_secret","secret","isPoint","pub","_pub","_pubBytes","fromPublic","fromSecret","prototype","pubBytes","encodePoint","decodePoint","g","mul","priv","privBytes","hash","lastIx","encodingLength","a","slice","decodeInt","update","digest","messagePrefix","sign","message","verify","sig","getSecret","enc","encode","getPublic","module","exports"],"sources":["C:/Users/Amali/Desktop/Building_the_IoT_w._P2P_and_Cloud_Computing/IoTProject/node_modules/elliptic/lib/elliptic/eddsa/key.js"],"sourcesContent":["'use strict';\r\n\r\nvar utils = require('../utils');\r\nvar assert = utils.assert;\r\nvar parseBytes = utils.parseBytes;\r\nvar cachedProperty = utils.cachedProperty;\r\n\r\n/**\r\n* @param {EDDSA} eddsa - instance\r\n* @param {Object} params - public/private key parameters\r\n*\r\n* @param {Array<Byte>} [params.secret] - secret seed bytes\r\n* @param {Point} [params.pub] - public key point (aka `A` in eddsa terms)\r\n* @param {Array<Byte>} [params.pub] - public key point encoded as bytes\r\n*\r\n*/\r\nfunction KeyPair(eddsa, params) {\r\n  this.eddsa = eddsa;\r\n  this._secret = parseBytes(params.secret);\r\n  if (eddsa.isPoint(params.pub))\r\n    this._pub = params.pub;\r\n  else\r\n    this._pubBytes = parseBytes(params.pub);\r\n}\r\n\r\nKeyPair.fromPublic = function fromPublic(eddsa, pub) {\r\n  if (pub instanceof KeyPair)\r\n    return pub;\r\n  return new KeyPair(eddsa, { pub: pub });\r\n};\r\n\r\nKeyPair.fromSecret = function fromSecret(eddsa, secret) {\r\n  if (secret instanceof KeyPair)\r\n    return secret;\r\n  return new KeyPair(eddsa, { secret: secret });\r\n};\r\n\r\nKeyPair.prototype.secret = function secret() {\r\n  return this._secret;\r\n};\r\n\r\ncachedProperty(KeyPair, 'pubBytes', function pubBytes() {\r\n  return this.eddsa.encodePoint(this.pub());\r\n});\r\n\r\ncachedProperty(KeyPair, 'pub', function pub() {\r\n  if (this._pubBytes)\r\n    return this.eddsa.decodePoint(this._pubBytes);\r\n  return this.eddsa.g.mul(this.priv());\r\n});\r\n\r\ncachedProperty(KeyPair, 'privBytes', function privBytes() {\r\n  var eddsa = this.eddsa;\r\n  var hash = this.hash();\r\n  var lastIx = eddsa.encodingLength - 1;\r\n\r\n  var a = hash.slice(0, eddsa.encodingLength);\r\n  a[0] &= 248;\r\n  a[lastIx] &= 127;\r\n  a[lastIx] |= 64;\r\n\r\n  return a;\r\n});\r\n\r\ncachedProperty(KeyPair, 'priv', function priv() {\r\n  return this.eddsa.decodeInt(this.privBytes());\r\n});\r\n\r\ncachedProperty(KeyPair, 'hash', function hash() {\r\n  return this.eddsa.hash().update(this.secret()).digest();\r\n});\r\n\r\ncachedProperty(KeyPair, 'messagePrefix', function messagePrefix() {\r\n  return this.hash().slice(this.eddsa.encodingLength);\r\n});\r\n\r\nKeyPair.prototype.sign = function sign(message) {\r\n  assert(this._secret, 'KeyPair can only verify');\r\n  return this.eddsa.sign(message, this);\r\n};\r\n\r\nKeyPair.prototype.verify = function verify(message, sig) {\r\n  return this.eddsa.verify(message, sig, this);\r\n};\r\n\r\nKeyPair.prototype.getSecret = function getSecret(enc) {\r\n  assert(this._secret, 'KeyPair is public only');\r\n  return utils.encode(this.secret(), enc);\r\n};\r\n\r\nKeyPair.prototype.getPublic = function getPublic(enc) {\r\n  return utils.encode(this.pubBytes(), enc);\r\n};\r\n\r\nmodule.exports = KeyPair;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}